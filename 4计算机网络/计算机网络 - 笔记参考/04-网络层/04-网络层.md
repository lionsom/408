[TOC]



# 1. 网络层功能概述

​	主要任务是把`分组`从源端传到目的端，为分组交换网上的不同主机提供提供通信服务。网络层传输单位是`数据报`。

> `功能一`：路由选择与分组转发【最佳路径】
>
> ![1620032016813](resource/1620032016813.png)
>
> `功能二`：异构网络互连【依靠`路由器`把 wifi、4G、校园网等网络互连，构成更大的网络】
>
> ![1620032046620](resource/1620032046620.png)
>
> `功能三`：拥塞控制
>
> ![1620032162532](resource/1620032162532.png)



# 2. 数据交换方式

## 2.1 进行数据交换的原因

![1620032447017](resource/1620032447017.png)

> 图一：实现主机间通信，需要大量通信链路
>
> 图二：所需通信链路减少了，但是无法支撑远距离通信以及大量主机接入的通信
>
> 图三：能很好的解决上述问题



## 2.2 电路交换

![1620032800640](resource/1620032800640.png)



## 2.3 报文交换

![1620032967638](resource/1620032967638.png)



## 2.4 分组交换

### 2.4.1 介绍

`分组`：把大的数据块(`报文`)分割成许多小的数据块

![1620033191510](resource/1620033191510.png)





### 2.4.1 数据报方式&虚电路方式

![1620033932759](resource/1620033932759.png)



#### 2.4.1.1 数据报介绍【因特网在使用】

![1620039524617](resource/1620039524617.png)



#### 2.4.1.2 虚电路介绍

![1620039774165](resource/1620039774165.png)



#### 2.4.1.3 数据报 & 虚电路

![1620039822963](resource/1620039822963.png)



### 2.4.2 几种传输单元对比

![1620039321385](resource/1620039321385.png)

## 2.5 报文交换 & 分组交换

![1620033502647](resource/1620033502647.png)



## 2.6 小结

![1620033627957](resource/1620033627957.png)



# 3. IP数据报

## 3.1 TCP/IP协议栈构造

![1620040158374](resource/1620040158374.png)



## 3.2 IP数据报格式

![1620040260602](resource/1620040260602.png)



![1620040544306](resource/1620040544306.png)

> 协议字段：TCP ==> 6  UDP ==> 17



## 3.3 IP数据报分片

### 3.3.1 最大传输单元MTU

![1620040804722](resource/1620040804722.png)

### 3.3.2 分片所涉及的首部字段

![1620041115317](resource/1620041115317.png)



**`【例题】`**

![1620041294392](resource/1620041294392.png)



### 3.3.3 部分字段单位

`一种八片首饰`【总长度单位是1Byte、片偏移单位是8Byte、首部长度单位是4Byte】

![1620041410636](resource/1620041410636.png)



# 4. IPv4地址

## 4.1 IP编址历史

* 分类的IP地址
* 子网的划分
* 构成超网【无分类编址方法】



## 4.2 分类的IP地址

### 4.2.1 IP地址介绍

![1620041933771](resource/1620041933771.png)



### 4.2.2 互联网中的IP地址

![1620042146733](resource/1620042146733.png)



### 4.2.3 分类方法

![1620042237647](resource/1620042237647.png)



### 4.2.4 特殊的IP地址

![1620042415669](resource/1620042415669.png)



### 4.2.5 私有IP地址

`路由器对目的地址是私有IP地址的数据报一律不进行转发`

![1620042557072](resource/1620042557072.png)



### 4.2.6 各类IP地址可指派数

![1620042731303](resource/1620042731303.png)



## 4.3 网络地址转换【NAT】

![1620043202996](resource/1620043202996.png)



## 4.4 子网划分与子网掩码

### 4.4.1 分类IP地址的缺点

![1620043390540](resource/1620043390540.png)



### 4.4.2 划分方法

![1620043485220](resource/1620043485220.png)



### 4.4.3 子网划分例子

![1620045479394](resource/1620045479394.png)



### 4.4.4 子网掩码

![1620045533257](resource/1620045533257.png)

【例题】

![1620045567890](resource/1620045567890.png)



### 4.4.5 使用子网时分组的转发

![1620045624579](resource/1620045624579.png)

## 4.5 无分类编址CIDR【构成超网】

### 4.5.1 介绍

![1620046014474](resource/1620046014474.png)

【例子】

![1620046123481](resource/1620046123481.png)



### 4.5.2 构成超网

![1620046407311](resource/1620046407311.png)



### 4.5.3 最长前缀匹配

![1620046567361](resource/1620046567361.png)

【习题】

![1620046655950](resource/1620046655950.png)



# 5. ARP协议

## 5.1 介绍

![1620047847800](resource/1620047847800.png)



## 5.2 发送数据的过程

【同一局域网络内】

![1620047277112](resource/1620047277112.png)



【不同局域网之间-01】

![1620047594623](resource/1620047594623.png)

【不同局域网之间-02】

![1620047654045](resource/1620047654045.png)



## 5.3 例题

![1620047928771](resource/1620047928771.png)



# 6. DHCP协议

## 6.1 主机如何获取IP地址

1. 静态配置：【如，学校电脑室，由管理员手动配置， IP地址、子网掩码、默认网关】

![1620094119921](resource/1620094119921.png)

2. 动态配置【如，学校教室，人员流动大，手机、电脑等主机设备不固定】

![1620094215257](resource/1620094215257.png)



## 6.2 DHCP 介绍

![1620093810055](resource/1620093810055.png)





# 7. ICMP协议

## 7.1 介绍

`网际控制报文协议`

![1620094727145](resource/1620094727145.png)

## 7.2 ICMP差错报文

### 7.2.1 五种类型

`第二点的源点抑制已经弃用`

![1620095020658](resource/1620095020658.png)



### 7.2.2 ICMP差错报文数据字段

![1620095294238](resource/1620095294238.png)



### 7.2.3 不发送ICMP差错报文的情况

![1620095373046](resource/1620095373046.png)



## 7.3 ICMP询问报文

`第三和四种报文已经弃用`

![1620095569009](resource/1620095569009.png)



## 7.4 ICMP应用

![1620095739574](resource/1620095739574.png)



# 8. IPv6

## 8.1 为什么使用IPv6

1. 32位IPv4地址空间已分配殆尽
2. CIDR、NAT等技术的应用治标不治本
3. IPv6能从根本上解决地址耗尽的问题
4. 改进了源IPv4的首部结果，使其能快速处理、转发数据报
5. 支持QoS【Quality of Service 服务质量】指一个网络能够利用各种基础技术，为指定的网络通信提供更好的服务能力，是网络的一种安全机制，是用来解决网络延迟和阻塞等问题的一种技术。



## 8.2 IPv6数据报格式

【简图】

![1620096269037](resource/1620096269037.png)

【详图】

![1620096492431](resource/1620096492431.png)



## 8.3 IPv6 & IPv4

![1620096660109](resource/1620096660109.png)



## 8.4 IPv6地址表示形式

![1620096751180](resource/1620096751180.png)



## 8.5 IPv6基本地址类型

![1620096930014](resource/1620096930014.png)



## 8.6 IPv6向IPv4过渡的策略

![1620097053729](resource/1620097053729.png)



# 9. 路由算法及相关路由协议

## 9.1 路由算法

### 9.1.1 路由表结构

![1620097406938](resource/1620097406938.png)



### 9.1.2 路由算法分类

![1620097573641](resource/1620097573641.png)



### 9.1.3 分层次的路由选择协议

![1620097732890](resource/1620097732890.png)

![1620097748834](resource/1620097748834.png)

## 9.2 RIP协议及距离向量算法

### 9.2.1 RIP协议

#### 9.2.1.1 介绍

![1620099752275](resource/1620099752275.png)



#### 9.2.1.2 RIP协议报文格式

![1620100899524](resource/1620100899524.png)



#### 9.2.1.3 特点

`好消息传的快，坏消息传的慢`

![1620100966990](resource/1620100966990.png)‘

![1620101109168](resource/1620101109168.png)

![1620101178026](resource/1620101178026.png)

![1620101194124](resource/1620101194124.png)

![1620101221030](resource/1620101221030.png)



### 9.2.2 路由信息交换规则

![1620100006910](resource/1620100006910.png)

### 9.2.3 距离向量算法

![1620100432774](resource/1620100432774.png)



【例题1】

![1620100588930](resource/1620100588930.png)

【例题2】

![1620100776711](resource/1620100776711.png)





### 9.2.4 小结

![1620101290859](resource/1620101290859.png)



## 9.3 OSPF协议及链路状态算法

### 9.3.1 OSPF协议

![1620113403966](resource/1620113403966.png)



### 9.3.2 链路状态路由算法

![1620113625354](resource/1620113625354.png)



### 9.3.3 OSPF的区域

![1620113763969](resource/1620113763969.png)



### 9.3.4 OSPF分组情况

![1620113819049](resource/1620113819049.png)



### 9.3.5 其他特点

![1620113895873](resource/1620113895873.png)



## 9.4 BGP协议

### 9.4.1 介绍

![1620113987626](resource/1620113987626.png)



### 9.4.2 BGP协议交换信息的过程

![1620114149635](resource/1620114149635.png)



![1620114218495](resource/1620114218495.png)

![1620114240132](resource/1620114240132.png)



### 9.4.3 BGP协议报文格式

![1620114310903](resource/1620114310903.png)



### 9.4.4 BGP协议特点

![1620114361910](resource/1620114361910.png)



### 9.4.5 BGP-4的四种报文

![1620114443629](resource/1620114443629.png)



## 9.5 三种路由协议比较

![1620114506325](resource/1620114506325.png)

![1620114588661](resource/1620114588661.png)



# 10. IP组播

## 10.1 IP数据报的三种传输方式

![1620114833384](resource/1620114833384.png)

【单播模式下-IP数据报的发送】

![1620116550096](resource/1620116550096.png)

【组播模式下-IP数据报的发送】

![1620116628519](resource/1620116628519.png)



## 10.2 IP组播地址

![1620116823094](resource/1620116823094.png)



## 10.3 硬件组播

![1620117053629](resource/1620117053629.png)



## 10.4 IGMP协议与组播路由协议

### 10.4.1 IGMP协议

`网际组管理协议IGMP`

#### 10.4.1.1 协议工作图解

![1620117315176](resource/1620117315176.png)

#### 10.4.1.2 协议在TCP/IP协议簇中的位置

![1620117353077](resource/1620117353077.png)



#### 10.4.1.3 IGMP工作的两个阶段

![1620117456653](resource/1620117456653.png)



### 10.4.2 组播路由选择协议

#### 10.4.2.1 介绍

![1620117561336](resource/1620117561336.png)

 



#### 10.4.2.2 常使用的三种算法

![1620117640444](resource/1620117640444.png)



# 11. 移动IP

## 11.1 相关术语

![1620117809438](resource/1620117809438.png)



## 11.2 通信过程

![1620117989923](resource/1620117989923.png)

![1620118048071](resource/1620118048071.png)



# 12. 网络层设备

## 12.1 路由器

### 12.1.1 介绍

![1620118187636](resource/1620118187636.png)



### 12.1.2 输入端口对线路上收到的分组的处理

![1620118295845](resource/1620118295845.png)



### 12.1.3 输出端口将交换结果传送来的分组发送到线路

![1620118446489](resource/1620118446489.png)



## 12.2 三层设备的区别

![1620118542666](resource/1620118542666.png)



## 12.3 路由表与路由转发

![1620118630369](resource/1620118630369.png)

