

# 第一章 计算机系统概述

## 1.1 操作系统基本概念

### 1.1.1 什么是操作系统

![](images/002.png)

![](images/003.png)



### 1.1.2 操作系统的特征

* 并发
* 共享
* 虚拟
* 异步

> 其中 **并发** 与 **共享** 是两个最基本的特征，二者互为存在条件。



#### 并发

##### 并发 VS 并行

> 并发：指两个或多个事件在 **同一时间间隔内**发生。这些事件 **宏观上是同时发生** 的，但 **微观上是交替发生** 的。 
>
> 并行：指两个或多个事件在 **同一时刻 同时发生**。

![](images/004.png)

##### 并发

> 操作系统的并发性：指计算机系统中“同时”运行着多个程序，这些程序 **宏观上看是同时运行** 着的，而 **微观上看是交替运行** 的。 
>
> 操作系统就是伴随着“多道程序技术”而出现的。因此，操作系统和程序并发是一起诞生的。



##### 并发考点*

> 注意（重要考点）： 
>
> **单核CPU** 同一时刻只能执行一个程序，各个程序只能 **并发** 地执行 
>
> **多核CPU** 同一时刻可以同时执行多个程序，多个程序可以 **并行** 地执行



#### 共享

> **共享 即 资源共享**，是指系统中的资源可供内存中多个并发执行的进程共同使用。 

* 两种资源共享方式：
    * 互斥共享：系统中的某些资源，虽然可以提供给多个进程使用，但一个时间段内只允许一个进程访问该资源
    * 同时共享：系统中的某些资源，允许一个时间段内由多个进程“同时”对它们进行访问

```
所谓的“同时”往往是宏观上的，而在微观上，这些进程可能是交替地对该资源进行访问的（即分时共享） 

生活实例： 
互斥共享方式：使用QQ和微信视频。同一时间段内摄像头只能分配给其中一个进程。 
同时共享方式：使用QQ发送文件A，同时使用微信发送文件B。宏观上看，两边都在同时读取并发送文件，说明两个进程都在访问硬盘资源，从中读取数据。微观上看，两个进程是交替着访问硬盘的。
```



#### 虚拟

>  **虚拟** 是指把一个物理上的实体变为若干个逻辑上的对应物。物理实体（前者）是实际存在的，而逻辑上对应物（后者）是用户感受到的。

* 虚拟技术

    * 空分复用技术（如：虚拟存储器技术）

        * 多个程序同时运行占用的CPU远远超过内存物理大小

        * 问题：这些程序同时运行需要的内存远大于4GB，那么为什么它们还可以在我的电脑上同时运行呢？ 

            答：这是 **虚拟存储器技术**。实际只有4GB的内存，在用户看来似乎远远大于4GB

    * 时分复用技术（如：虚拟处理器）

        * 某单核CPU的计算机中，用户打开多款软件时，正常运行。

        * 问题：既然一个程序需要被分配CPU才能正常执行，那么为什么单核CPU的电脑中能同时运行这么多个程序呢？

            答：这是 **虚拟处理器技术**。实际上只有一个单核CPU，在用户看来似乎有 6个CPU在同时为自己服务。

```
显然，如果失去了并发性，则一个时间段内系统中只需运行一道程序，那么就失去了实现虚拟性的意义了。因此，没有并发性，就谈不上虚拟性。
```



#### 异步

> **异步**：指在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的， 而是走走停停，以不可预知的速度向前推进，这就是进程的异步性。

![](images/005.png)



#### 小结

![](images/006.png)





### 1.1.3 操作系统的功能与作用

![](images/001.png)



## 1.2 操作系统发展与分类

![](images/007.png)



## 1.3 操作系统运行机制

* 两种程序
    * 内核程序
    * 应用程序
* 两种指令
    * 特权指令
    * 非特权指令
* 两种处理器状态
    * 核心态
    * 用户态

```
『应用程序』只能使用『非特权指令』，如：加法指令、减法指令等；
『操作系统内核』作为 “管理者”，有时会让CPU执行一些『特权指令』，如：内存清零指令。这些指令影响重大， 只允许“管理者”——即操作系统内核来使用。

在CPU设计和生产的时候就划分了『特权指令』和『非特权指令』，因此CPU执行一条指令前就能判断出其类型。

问题：
 CPU 能判断出指令类型，但是它怎么区分此时正在运行的是内核程序 or 应用程序？
解决：
 CPU 有两种状态，“内核态”和“用户态” 
 处于内核态时，说明此时正在运行的是内核程序，此时可以执行特权指令 
 处于用户态时，说明此时正在运行的是应用程序，此时只能执行非特权指令

拓展：
 CPU 中有一个寄存器叫 程序状态字寄存器（PSW），其中有个二进制位，1表示 
 “内核态”，0表示“用户态” 
 别名：内核态=核心态=管态；用户态=目态
```



### 1.3.1 内核态、用户态 切换

> **内核态 —> 用户态**：执行一条 **特权指令**——**修改PSW的标志位为“用户态”**，这个动作意味着 **操作系统将主动让出CPU使用权**。
>
> **用户态 —> 内核态**：由 **“中断”** 引发，硬件自动完成变态过程，触发中断信号意味着 **操作系统将强行夺回CPU的使用权**。





